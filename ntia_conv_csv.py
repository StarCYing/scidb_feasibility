import csv, pprint, numpy as np

pp = pprint.PrettyPrinter(indent=2)

def import_dat(line, args):
    position = 0
    for length in args:
        yield line[position:position+length].strip()
        position += length

def export_ntia(fname, header, args):
    export_csv = [header]
    with open('./%s.dat'%fname,'rb') as f:
        # first_line = f.readline()
        # readme = list(import_dat(first_line,args))
        # position = 0
        # for i, val in enumerate(readme):
        #     print '%s (%s,%s-%s): %s'%(header[i], i, position + 1, position + args[i] ,val)
        #     position += args[i]
        # print len(first_line)
        for line in f:
            export_csv.append(list(import_dat(line,args)))
    np.savetxt('./%s.csv'%fname, export_csv, delimiter=',', fmt='%s')

header = ['HRHHID','HRMONTH','HRYEAR4','HURESPLI','HUFINAL','HUSPNISH','HETENURE','HEHOUSUT','HETELHHD','HETELAVL','HEPHONEO','HEFAMINC','HUTYPEA','HUTYPB','HUTYPC','HWHHWGT','HRINTSTA','HRNUMHOU','HRHTYPE','HRMIS','HUINTTYP','HUPRSCNT','HRLONGLK','HRHHID2','FILLER','HUBUS','HUBUSL1','HUBUSL2','HUBUSL3','HUBUSL4','GEREG','GESTCEN','GESTFIPS','FILLER','GTCBSA','GTCO','GTCBSAST','GTMETSTA','GTINDVPC','GTCBSASZ','GTCSA','FILLER','FILLER','PUPELIG','PERRP','PEPARENT','PRTAGE','PRTFAGE','PEMARITL','PESPOUSE','PESEX','PEAFEVER','FILLER','PEAFNOW','PEEDUCA','PTDTRACE','PRDTHSP','PUCHINHH','FILLER','PULINENO','FILLER','PRFAMNUM','PRFAMREL','PRFAMTYP','PEHSPNON','PRMARSTA','PRPERTYP','PENATVTY','PEMNTVTY','PEFNTVTY','PRCITSHP','PRCITFLG','PRINUSYR','PUSLFPRX','PEMLR','PUWK','PUBUS1','PUBUS2OT','PUBUSCK1','PUBUSCK2','PUBUSCK3','PUBUSCK4','PURETOT','PUDIS','PERET1','PUDIS1','PUDIS2','PUABSOT','PULAY','PEABSRSN','PEABSPDO','PEMJOT','PEMJNUM','PEHRUSL1','PEHRUSL2','PEHRFTPT','PEHRUSLT','PEHRWANT','PEHRRSN1','PEHRRSN2','PEHRRSN3','PUHROFF1','PUHROFF2','PUHROT1','PUHROT2','PEHRACT1','PEHRACT2','PEHRACTT','PEHRAVL','FILLER','PUHRCK1','PUHRCK2','PUHRCK3','PUHRCK4','PUHRCK5','PUHRCK6','PUHRCK7','PUHRCK12','PULAYDT','PULAY6M','PELAYAVL','PULAYAVR','PELAYLK','PELAYDUR','PELAYFTO','PULAYCK1','PULAYCK2','PULAYCK3','PULK','PELKM1','PULKM2','PULKM3','PULKM4','PULKM5','PULKM6','PULKDK1','PULKDK2','PULKDK3','PULKDK4','PULKDK5','PULKDK6','PULKPS1','PULKPS2','PULKPS3','PULKPS4','PULKPS5','PULKPS6','PELKAVL','PULKAVR','PELKLL1O','PELKLL2O','PELKLWO','PELKDUR','PELKFTO','PEDWWNTO','PEDWRSN','PEDWLKO','PEDWWK','PEDW4WK','PEDWLKWK','PEDWAVL','PEDWAVR','PUDWCK1','PUDWCK2','PUDWCK3','PUDWCK4','PUDWCK5','PEJHWKO','PUJHDP1O','PEJHRSN','PEJHWANT','PUJHCK1','PUJHCK2','PRABSREA','PRCIVLF','PRDISC','PREMPHRS','PREMPNOT','PREXPLF','PRFTLF','PRHRUSL','PRJOBSEA','PRPTHRS','PRPTREA','PRUNEDUR','FILLER','PRUNTYPE','PRWKSCH','PRWKSTAT','PRWNTJOB','PUJHCK3','PUJHCK4','PUJHCK5','PUIODP1','PUIODP2','PUIODP3','PEIO1COW','PUIO1MFG','PADDING','PEIO2COW','PUIO2MFG','PADDING','PUIOCK1','PUIOCK2','PUIOCK3','PRIOELG','PRAGNA','PRCOW1','PRCOW2','PRCOWPG','PRDTCOW1','PRDTCOW2','PRDTIND1','PRDTIND2','PRDTOCC1','PRDTOCC2','PREMP','PRMJIND1','PRMJIND2','PRMJOCC1','PRMJOCC2','PRMJOCGR','PRNAGPWS','PRNAGWS','PRSJMJ','PRERELG','PEERNUOT','PEERNPER','PEERNRT','PEERNHRY','PUERNH1C','PEERNH2','PEERNH1O','PRERNHLY','PTHR','PEERNHRO','PRERNWA','PTWK','FILLER','PEERN','PUERN2','PTOT','FILLER','PEERNWKP','PEERNLAB','PEERNCOV','PENLFJH','PENLFRET','PENLFACT','PUNLFCK1','PUNLFCK2','PESCHENR','PESCHFT','PESCHLVL','PRNLFSCH','PWFMWGT','PWLGWGT','PWORWGT','PWSSWGT','PWVETWGT','PRCHLD','PRNMCHLD','FILLER','PRWERNAL','PRHERNAL','HXTENURE','HXHOUSUT','HXTELHHD','HXTELAVL','HXPHONEO','PXINUSYR','PXRRP','PXPARENT','PXAGE','PXMARITL','PXSPOUSE','PXSEX','PXAFWHN1','PXAFNOW','PXEDUCA','PXRACE1','PXNATVTY','PXMNTVTY','PXFNTVTY','FILLER','PXHSPNON','PXMLR','PXRET1','PXABSRSN','PXABSPDO','PXMJOT','PXMJNUM','PXHRUSL1','PXHRUSL2','PXHRFTPT','PXHRUSLT','PXHRWANT','PXHRRSN1','PXHRRSN2','PXHRACT1','PXHRACT2','PXHRACTT','PXHRRSN3','PXHRAVL','PXLAYAVL','PXLAYLK','PXLAYDUR','PXLAYFTO','PXLKM1','PXLKAVL','PXLKLL1O','PXLKLL2O','PXLKLWO','PXLKDUR','PXLKFTO','PXDWWNTO','PXDWRSN','PXDWLKO','PXDWWK','PXDW4WK','PXDWLKWK','PXDWAVL','PXDWAVR','PXJHWKO','PXJHRSN','PXJHWANT','PXIO1COW','PXIO1ICD','PXIO1OCD','PXIO2COW','PXIO2ICD','PXIO2OCD','PXERNUOT','PXERNPER','PXERNH1O','PXERNHRO','PXERN','FILLER','PXERNWKP','PXERNRT','PXERNHRY','PXERNH2','PXERNLAB','PXERNCOV','PXNLFJH','PXNLFRET','PXNLFACT','PXSCHENR','PXSCHFT','PXSCHLVL','QSTNUM','OCCURNUM','PEDIPGED','PEHGCOMP','PECYC','PEGRPROF','PEGR6COR','PEMS123','PXDIPGED','PXHGCOMP','PXCYC','PXGRPROF','PXGR6COR','PXMS123','PWCMPWGT','PEIO1ICD','PEIO1OCD','PEIO2ICD','PEIO2OCD','PRIMIND1','PRIMIND2','PEAFWHN1','PEAFWHN2','PEAFWHN3','PEAFWHN4','PXAFEVER','PELNDAD','PELNMOM','PEDADTYP','PEMOMTYP','PECOHAB','PXLNDAD','PXLNMOM','PXDADTYP','PXMOMTYP','PXCOHAB','PEDISEAR','PEDISEYE','PEDISREM','PEDISPHY','PEDISDRS','PEDISOUT','PRDISFLG','PXDISEAR','PXDISEYE','PXDISREM','PXDISPHY','PXDISDRS','PXDISOUT','HXFAMINC','FILLER','HESCI1','HESC2a1','HESC2a2','HESC2a3','HESC2a4','HESC2a5','HESC2a6','HESC2a7','HESC2a8','HESC2a9','HESC2a10','HESC2a11','HENET2','HENET3','HENET3a','HENET41','HENET42','HENET43','HENET44','HENET45','HENET46','HENET47','HENET5','HENET5b1','HENET5b2','HENET5b3','HENET5b4','HENET5c','HENET6','HENET6a','HENET7','HENET7a','HESCI11','HESCI121','HESCI122','HESCI123','HESCI124','HTSCI13','HTSCI14','HESCI15','HESCI16','HESCI17','PEPERSCR','PEHOME','PESCHL','PEWRKA','PELIBR','PECOMM','PECAFE','PEELHS','PEDESK','PELAPT','PETABL','PECELL','PEGAME','PETVBA','PEPRIM1','PTPRIM2','PEPRM31','PEPRM32','PEPRM33','PEPRM34','PEPRM35','PEPRM36','PEPRM37','PEPRM38','PEPRM39','PEPRM310','PEPRM311','PEPRM312','PEPRM313','PEPRM314','PEPRM315','PEPRM316','PEPRM317','PEPRIM12','PEPRM141','PEPRM142','PEPRM143','PEPRM144','PEPRM145','PEPRM146','PEPRM147','PEPRM151','PEPRM152','PEPRM153','PEPRM154','PEPRM155','PEPRM156','PEPRM15b','PEPRM161','PEPRM162','PEPRM163','PEPRM164','PEPRM16b','PUELGFLG','PWPRMWGT','HWSUPWGT','PWSUPWGT']

args = [15,2,4,2,3,2,2,2,2,2,2,2,2,2,2,10,2,2,2,2,2,2,2,5,3,2,2,2,2,2,2,2,2,1,5,3,1,1,1,1,3,3,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,3,2,5,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,6,2,2,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,1,2,8,1,4,8,8,1,2,2,2,2,2,2,2,2,2,2,2,2,2,10,10,10,10,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,2,2,2,2,2,5,2,2,2,2,2,2,2,2,2,2,2,2,2,10,4,4,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,17,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,10,10]

export_ntia('cps_int_jul13pub', header, args)